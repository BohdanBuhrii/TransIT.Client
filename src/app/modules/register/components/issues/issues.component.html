<div class="table-background border mt-3">
  <h2 class="table-caption">
      {{'Register.MyIssues'| translate}}
  </h2>
  <app-create-issue (addIssue)="reloadTable()"></app-create-issue>
  <app-issue-details [issue]="selectedIssue"></app-issue-details>
  <app-delete-issue [issue]="selectedIssue" (deleteIssue)="reloadTable()"></app-delete-issue>
  <table id="issues" datatable [dtOptions]="options" [dtTrigger]="renderTrigger" class="table table-bordered">
    <thead>
      <tr>
        <th>{{'Register.Number'| translate}}</th>
        <th>{{'Register.Transport'| translate}}</th>
        <th>{{'Register.Status'| translate}}</th>
        <th>{{'Register.Malfunction'| translate}}</th>
        <th>{{'Register.Date'| translate}}</th>
        <th>{{'Register.Description'| translate}}</th>
        <th>{{'Register.Action'| translate}}</th>
      </tr>
    </thead>
    <tbody *ngIf="issues?.length !== 0">
      <tr *ngFor="let issue of issues" [ngClass]="getPriorityClass(issue)">
        <td>{{ issue.number }}</td>
        <td [attr.title]="issue.vehicle.name">{{ issue.vehicle.name | truncate }}</td>
        <td [attr.title]="issue.state.transName">{{ issue.state.transName | truncate }}</td>
        <td [attr.title]="issue.malfunction.name">{{ issue.malfunction.name | truncate }}</td>
        <td [attr.title]="issue.date">{{ issue.date | date: 'yyyy-MM-dd' }}</td>
        <td [attr.title]="issue.summary">{{ issue.summary | truncate }}</td>
        <td>
          <div class="d-flex flex-nowrap">
            <button (click)="selectIssue(issue)" class="btn" data-toggle="modal" data-target="#editModal">
              <i class="fas fa-info-circle"></i>
            </button>
            <button
              *ngIf="issue.deletable"
              (click)="selectIssue(issue)"
              class="btn"
              data-toggle="modal"
              data-target="#deleteModal"
            >
              <i class="fas fa-trash-alt"></i>
            </button>
          </div>
        </td>
      </tr>
    </tbody>
  </table>
</div>
